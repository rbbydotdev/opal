@import "@mdxeditor/editor/style.css";

.mdxeditor-popup-container {
  z-index: 10 !important;
}
.content-editable {
  max-width: 100%;
  height: 100%;
  min-width: 400px;
}
.mdxeditor-root-contenteditable {
  min-height: 0;
  flex-grow: 1;
}
.mdxeditor-toolbar {
  border-radius: 0;
  flex-shrink: 0;
  &::-webkit-scrollbar {
    display: none;
  }
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.mdxeditor {
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.mdxeditor .cm-selectionBackground {
  background-color: hsl(var(--search-highlight-bg)) !important;
}

.mdxeditor .cm-highlight-range {
  background-color: hsl(var(--search-highlight-bg)) !important;
  & > * {
    color: hsl(var(--search-highlight-fg)) !important;
  }
}

.mdxeditor-popup-container [class*="_dialogContent_"] {
  flex-direction: column;
}

.mdxeditor {
  [data-editor-block-type="image"] {
    border: 1px solid hsl(var(--border));
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
  [data-editor-block-type="image"] img {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    outline: none;
  }
}

.mdxeditor-root-contenteditable,
.mdxeditor-rich-text-editor .content-editable,
.mdxeditor-diff-source-wrapper,
.mdxeditor-rich-text-editor,
.mdxeditor-root-contenteditable > div {
  height: 100%;
  /* overflow: hidden; */
}
.mdxeditor-rich-text-editor .content-editable {
  background-color: transparent !important;
}

.mdxeditor [data-lexical-decorator="true"] {
  /* this fixes scroll to calculations */
  display: inline-block;
}

.mdxeditor-source-editor .cm-focused .cm-matchingBracket {
  outline: none !important;
}

.mdxeditor-source-editor .cm-nonmatchingBracket {
  outline: none !important;
}

.hide-rich-text .mdxeditor {
  /* super hack to hide rich text editor */
  [class^="_diffSourceToggleWrapper_"] {
    display: none;
  }
}

.mdxeditor::selection {
  @apply bg-ring text-primary-foreground;
}

.mdxeditor {
  /* for scroll into view to work properly*/
  .cm-editor {
    /* height: 100vh; */
  }
  .cm-scroller {
    height: 100%;
  }
}

.mdxeditor {
  hr {
    width: 100%;
    margin-top: 1rem;
    margin-bottom: 1rem;
  }
}

/* MDXEditor Theme Integration with Shadcn Colors */
.mdxeditor {
  /* Base colors - using shadcn muted/background colors */
  --baseBase: var(--background) !important;
  --baseBgSubtle: var(--muted) !important;
  --baseBg: var(--card) !important;
  --baseBgHover: var(--accent) !important;
  --baseBgActive: var(--accent) !important;
  --baseLine: var(--border) !important;
  --baseBorder: var(--border) !important;
  --baseBorderHover: var(--input) !important;
  --baseSolid: var(--muted-foreground) !important;
  --baseSolidHover: var(--foreground) !important;
  --baseText: var(--foreground) !important;
  --baseTextContrast: var(--foreground) !important;

  /* Accent colors - using shadcn primary colors */
  --accentBase: var(--primary) !important;
  --accentBgSubtle: var(--secondary) !important;
  --accentBg: var(--secondary) !important;
  --accentBgHover: var(--secondary) !important;
  --accentBgActive: var(--secondary) !important;
  --accentLine: var(--primary) !important;
  --accentBorder: var(--primary) !important;
  --accentBorderHover: var(--primary) !important;
  --accentSolid: var(--primary) !important;
  --accentSolidHover: var(--primary) !important;
  --accentText: var(--primary) !important;
  --accentTextContrast: var(--primary-foreground) !important;

  /* Admonition colors - using available shadcn colors */
  --admonitionTipBg: var(--secondary) !important;
  --admonitionTipBorder: var(--border) !important;

  --admonitionInfoBg: var(--secondary) !important;
  --admonitionInfoBorder: var(--border) !important;

  --admonitionCautionBg: var(--secondary) !important;
  --admonitionCautionBorder: var(--border) !important;

  --admonitionDangerBg: var(--destructive) !important;
  --admonitionDangerBorder: var(--destructive) !important;

  --admonitionNoteBg: var(--muted) !important;
  --admonitionNoteBorder: var(--border) !important;

  /* Typography - using shadcn font variables if available */
  font-family: var(
    --font-sans,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    Oxygen,
    Ubuntu,
    Cantarell,
    "Open Sans",
    "Helvetica Neue",
    sans-serif
  ) !important;
  --font-mono: var(
    --font-mono,
    ui-monospace,
    SFMono-Regular,
    Menlo,
    Monaco,
    Consolas,
    "Liberation Mono",
    "Courier New",
    monospace
  ) !important;

  /* Background and text colors */
  color: var(--foreground) !important;
  --basePageBg: var(--background) !important;
  background: var(--background) !important;

  /* Ensure proper contrast in content editable */
  .mdxeditor-root-contenteditable {
    color: var(--foreground) !important;
    > div {
      /* weird */
      overflow-x: scroll;
    }
  }

  /* Fix caret color */
  .mdxeditor-root-contenteditable,
  .content-editable {
    caret-color: var(--foreground) !important;
  }
}

.mdxeditor {
  img {
    max-width: 32rem;
    margin: auto;
    display: block;
  }
}
.mdxeditor.center-images p span[data-lexical-decorator]:has(img) {
  display: block;
  margin: auto;
  text-align: center;
}
